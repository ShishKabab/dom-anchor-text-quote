!function(t,e){if("function"==typeof define&&define.amd)define(["exports","module","diff-match-patch","dom-anchor-text-position","dom-seek"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module,require("diff-match-patch"),require("dom-anchor-text-position"),require("dom-seek"));else{var n={exports:{}};e(n.exports,n,t.DiffMatchPatch,t.TextPositionAnchor,t.seek),t.domAnchorTextQuote=n.exports}}(this,function(t,e,n,r,o){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=i(n),s=i(r),c=(i(o),function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(a(this,t),void 0===e)throw new Error('missing required parameter "exact"');this.exact=e,this.prefix=n.prefix,this.suffix=n.suffix}return f(t,[{key:"toRange",value:function(){return this.toPositionAnchor().toRange()}},{key:"toSelector",value:function(){var t={type:"TextQuoteSelector",exact:this.exact};return void 0!==this.prefix&&(t.prefix=this.prefix),void 0!==this.suffix&&(t.suffix=this.suffix),t}},{key:"toPositionAnchor",value:function(){var t=global.document.body,e=new u["default"];e.Match_Distance=2*t.textContent.length;var n=function(n,r){var o=e.match_main(t.textContent,r,n.loc);if(-1===o)throw new Error("no match found");return n.loc=o+r.length,n.start=Math.min(n.start,o),n.end=Math.max(n.end,o+r.length),n},r=this.exact.match(/(.|[\r\n]){1,32}/g),o=t.textContent.length/2,i=-1,a=-1;if(void 0!==this.prefix){var f=e.match_main(t.textContent,this.prefix,o);f>-1&&(o=a=i=f+this.prefix.length)}if(-1===i){var c=r.shift();if(result=e.match_main(t.textContent,c,o),!(result>-1))throw new Error("no match found");i=result,o=a=i+c.length}e.Match_Distance=64;var h=r.reduce(n,{start:i,end:a,loc:o});return new s["default"](h.start,h.end)}}],[{key:"fromRange",value:function(t){if(void 0===t)throw new Error('missing required parameter "range"');var e=s["default"].fromRange(t);return this.fromPositionAnchor(e)}},{key:"fromSelector",value:function(e){if(void 0===e)throw new Error('missing required parameter "selector"');var n=e.exact,r=e.prefix,o=e.suffix;return new t(n,{prefix:r,suffix:o})}},{key:"fromPositionAnchor",value:function(e){var n=global.document.body,r=e.start,o=e.end,i=n.textContent.substr(r,o-r),a=Math.max(0,r-32),f=n.textContent.substr(a,r-a),u=Math.min(n.textContent.length,o+32),s=n.textContent.substr(o,u-o);return new t(i,{prefix:f,suffix:s})}}]),t}());e.exports=c});
//# sourceMappingURL=dom-anchor-text-quote.min.js.map